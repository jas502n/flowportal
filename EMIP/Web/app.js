function _014ec09341ddaeb3a1a05fccd580a341919b4376(){};function _3670ca3c9f564c4403e0c75bab917059a54d6145(){};function _00984ef3cfa62ef8a6080ce543ccfbb2c65431ff(){};function _4aea6fdb9c7c9505cb7e58dbc98817560d011755(){};function _0940c8dc1ba95182d5502554aae4f8abfee29fa3(){};function _422e6f47cdba214024a35b72b392b4e32c069f83(){};function _48d1e93bd3cf7ba0a47e14c5f6a14cfae16e556c(){};function _ce55864dcd5704cb10da057e289d1754038348d2(){};function _310890be1e1619a1879068759f60a7ee8fef52ed(){};function _4ff49fce230343c68a058dde43c7d35e34a70bcf(){};function _e65bb14be780d6e4811093421ea6d57da3866d22(){};function _411c8ca9d177fb93b15366c6ba27f12ae0fe1626(){};function _756c2ad902565b6a01819c50e551ef4fdb7ad66b(){};function _3ffcf7f31dbbf7403f4d419e7db40605aff0a823(){};function _53752490773fe8fcf6c60574aa4df411a8812e0b(){};function _1b2759ab0b29768dc69553098133c7cda1d5df66(){};function _cdda5d7a1b8cdc19be90738179ab125d9a745104(){};function _745cf365a44996bb193a148fb079de92f3808be1(){};function _9b55f591ad11c6b88e8013b2d2c2c35c70d59859(){};function _fdbaf9ca0889b572bb0d9d4e99c4176c9bd1eb17(){};function _0241748e3573104bed8c1ede02bc0a11978626dd(){};function _206f4cd31f8e162ea5f2766fd7c88a2c6946251f(){};function _dd36fba2c8ec78bd2ef08d169dac4424e0eaa3c8(){};function _cbee3d1a8e88b179bac270637ae2cbfeb2584ec7(){};function _597f98b914b9f324d7d3a086440a40a2d634681b(){};function _8d42a034e9cb9daba8d740eb6114df3742740293(){};function _02604b5cef432f4d47a5f6352a78c03be5283d27(){};function _e414b0469a6fb15bcb80854af4d7363930706c12(){};function _7939922b00cac70b97e86d059ed8bda78fe47790(){};function _295d90ac422db64f2dcbb5e469abe0af27f1fcfc(){};function _1c7793c63cf72827938cbb091f18d283d7a1998c(){};function _281cc27e5a53c50ec548ced066deb676c3645820(){};function _059d4caed348aeaaad0c6b24dc8e4592d5d74bda(){};function _06a4acc4a8cb4f34776213c86a66bfab9894d93b(){};function _dc70e1158eadffa54823fd9a4ed8a731f2795ae1(){};function _727d3139b24d1b1879df43629cdf570a95c7abcc(){};function _fc7aae794bb34b1dd9f0d0ad74414280284e45a3(){};function _9de9127002d4cdb24f6880d3299cf5864010c73f(){};function _1bf29a2f5964a37b811dabf019ec209d3530aa10(){};function _09c279922f4b846a0aaeec306d23d0c56b4318be(){};function _743eb52e07af1905f680b4eb0003bb934883b90d(){};function _c492ff65c4a387e37e9d9bd73c4f30c3eef7d36d(){};function _08faa2ffaba88a5d1c7cfa6aa9340eb33f21e01a(){};function _408a5eed778e50195d5ed2767aa3d3b0596f2a75(){};function _5696498da0183b4d8ee26f30ec2e5188d08389a2(){};function _a0a2a6fd50daa08d454b1143e95b03566626007d(){};function _3329c33309e2e86f03d67ee53ea3f5af31a6af02(){};function _b5f8dfc377921b3cfa85a3fd00849cd5be29b6f5(){};function _34ee6bd0539cf743a3046bd06e78ad4b4fa0551e(){};function _911838ed8ac33f8a38c916649c6226488c727521(){};function _d72ff27b156fe0fbf8b7b92f7c586a8307ed4904(){};function _bda44376e0927a2babec4d04270eacbe50e9d722(){};function _8455654c6403df06c8cf22d2865495534e52dee3(){};function _9c0d7dbeb8ba86819ed3a04cd7b368397c2d7fc2(){};function _c0c09a2346089f79e0e4579db537f65222cf7853(){};function _c7d8d9458a3d0b4fca71da94c2d9e7bc8671f37e(){};function _b2434e23e04c929b9315f0e367e73c11f7976674(){};function _eaa30eaf63e511b86b1ae1f29d2cdf089312e738(){};function _f1c263576fa36e3a45f9fa2a238bc05e32cdaac6(){};function _4346c252aab13400617728c920c8b943cc80734d(){};function _5446f0b3631fbbf39bf23886dd1a41fba3319773(){};function _c63d5ea8e9a4d7d172e650e91ff31712d37a420a(){};function _5443b1a314b37389301705ffecf8d5b59e1a2c47(){};function _7ace137ea8278fe74a6519f1718f80e05bbf7372(){};function _a35d8d646a351b99715efc5dd2d5fe927401409b(){};function _33c97bb32bfcdbece997f478aee07e858c0edd01(){};function _0f82beae54b6606296e98186947e87ba0ac6ca2c(){};function _16467adad123cf640662fb8905b1925f014dd5b1(){};/*
    This file is generated and updated by Sencha Cmd. You can edit this file as
    needed for your application, but these edits will have to be merged by
    Sencha Cmd when it performs code generation tasks such as generating new
    models, controllers or views and when running "sencha app upgrade".

    Ideally changes to this file would be limited and most work would be done
    in other places (such as Controllers). If Sencha Cmd cannot merge your
    changes and its generated code, it will produce a "merge conflict" that you
    will need to resolve manually.
*/

application.pushPhase('app start');

application = Ext.apply(application, {
    //trialUrl: 'http://192.169.1.100/emip'
    trialUrl: 'http://emip.flowportal.com/emip'
    //serverUrl: 'http://demo.flowportal.net/emip'
    //serverUrl: 'http://192.169.1.100/emip'
});

Ext.Loader.setConfig({
    enabled: true
});

Ext.Loader.setPath({
    Ext: 'touch/src'
});

Ext.application({
    name: 'emip',
    backupItems: {
        'Ext.Loader': [
            'classNameToFilePathMap',
            'history',
            'isClassFileLoaded',
            'isFileLoaded',
            'isInHistory',
            'requiredByMap',
            'requiresMap'
        ],
        'Ext.ClassManager': [
            'classes',
            'existCache',
            'maps'
        ]
    },
    requires: [
        'Ext.MessageBox',
        'Ext.form.FieldSet',
        'Ext.picker.Date',
        'Ext.Video',
        'Ext.tab.Panel',
        'Ext.plugin.PullRefresh',
        'Ext.dataview.List',
        'Ext.dataview.DataView',
        'Ext.field.Password',
        'Ext.Anim',
        'Ext.plugin.ListPaging',
        'Ext.Img',
        'Ext.field.Select',
        'Ext.field.Number',
    /*-------编译时放出开始---------*/
    //'Ext.device.Connection'
    /*-------编译时放出结束---------*/
    /*'Ext.chart.CartesianChart',
    'Ext.chart.Legend',
    'Ext.chart.PolarChart',
    'Ext.chart.SpaceFillingChart',
    'Ext.chart.axis.Axis',
    'Ext.chart.axis.Category',
    'Ext.chart.axis.Numeric',
    'Ext.chart.axis.Time',
    'Ext.chart.axis.layout.CombineDuplicate',
    'Ext.chart.axis.layout.Continuous',
    'Ext.chart.axis.layout.Discrete',
    'Ext.chart.axis.segmenter.Names',
    'Ext.chart.axis.segmenter.Numeric',
    'Ext.chart.axis.segmenter.Time',
    'Ext.chart.grid.CircularGrid',
    'Ext.chart.grid.HorizontalGrid',
    'Ext.chart.grid.RadialGrid',
    'Ext.chart.grid.VerticalGrid',
    'Ext.chart.interactions.Abstract',
    'Ext.chart.interactions.CrossZoom',
    'Ext.chart.interactions.Crosshair',
    'Ext.chart.interactions.ItemHighlight',
    'Ext.chart.interactions.ItemInfo',
    'Ext.chart.interactions.PanZoom',
    'Ext.chart.interactions.Rotate',
    'Ext.chart.interactions.RotatePie3D',
    'Ext.chart.series.Area',
    'Ext.chart.series.Bar',
    'Ext.chart.series.CandleStick',
    'Ext.chart.series.Gauge',
    'Ext.chart.series.Line',
    'Ext.chart.series.Pie',
    'Ext.chart.series.Pie3D',
    'Ext.chart.series.Radar',
    'Ext.chart.series.Scatter',
    'Ext.chart.series.sprite.Area',
    'Ext.chart.series.sprite.Bar',
    'Ext.chart.series.sprite.CandleStick',
    'Ext.chart.series.sprite.Line',
    'Ext.chart.series.sprite.Pie3DPart',
    'Ext.chart.series.sprite.PieSlice',
    'Ext.chart.series.sprite.Radar',
    'Ext.chart.series.sprite.Scatter',
    'Ext.chart.Chart'*/
    ],
    isIconPrecomposed: true,
    icon: {
        '57': 'resources/icons/Icon.png',
        '72': 'resources/icons/Icon~ipad.png',
        '114': 'resources/icons/Icon@2x.png',
        '144': 'resources/icons/Icon~ipad@2x.png'
    },
    startupImage: {
        '320x460': 'resources/startup/320x460.jpg',
        '640x920': 'resources/startup/640x920.png',
        '768x1004': 'resources/startup/768x1004.png',
        '748x1024': 'resources/startup/748x1024.png',
        '1536x2008': 'resources/startup/1536x2008.png',
        '1496x2048': 'resources/startup/1496x2048.png'
    },

    launch: function () {
        var me = this,
            noconn = false,
            qs, urlParams, mode, logout, strservers, uid, pwd, servers = [], server;

        application.app = me;

        application.isApp = !!(Ext.browser.is.WebView && Ext.browser.is.Cordova);

        if (Ext.ClassManager.isCreated('Ext.device.Connection'))
            noconn = !Ext.device.Connection.isOnline();

        //application.isApp = true;
        application.specifiedServer = !!application.serverUrl;

        YZLoader.init();

        qs = Ext.String.trim(document.location.search);
        if (qs.charAt(0) == '?')
            qs = qs.substring(1);

        urlParams = Ext.Object.fromQueryString(qs) || {};
        mode = (urlParams.mode || '').toLowerCase();

        //创建主窗口
        Ext.mainWin = Ext.create('Ext.navigation.View', {
            navigationBar: false,
            cls: 'yz-mainwin'
        });

        Ext.Viewport.add(Ext.mainWin);

        Ext.Loader.setPath({
            YZSoft$Boot: 'YZSoft$Boot',
            YZSoft$Local: 'YZSoft$Local',
            YZSoft: 'YZSoft'
        });

        //me.backup();

        if (application.isApp) {
            try {
                logout = localStorage.getItem('logout');
                strservers = localStorage.getItem('servers');
                Ext.Array.each(strservers ? Ext.decode(strservers) : [], function (server) {
                    if (server.url)
                        servers.push(server);
                });
                uid = localStorage.getItem('uid');
                pwd = localStorage.getItem('pwd');
            }
            catch (exp) {
                servers = [];
                uid = '';
            }

            server = (servers && servers[0]) || { url: '' };

            //app自动登录
            if (!noconn && logout != 'true' && server && server.url && uid) {
                var url = server.url + '/';

                Ext.Loader.setPath({
                    YZSoft$Server: url + 'YZSoft$Server'
                });

                me.autoLogin({
                    uid: uid,
                    pwd: pwd,
                    fn: function (result) {
                        if (result.LocalLibrary !== true) {
                            Ext.Loader.setPath({
                                YZSoft: url + 'YZSoft'
                            });
                        }

                        application.pushPhase('autoLogin');
                        try {
                            localStorage.setItem('logout', 'false');
                        }
                        catch (exp) {
                        }

                        YZLoader.loadCss(YZLoader.$url('YZSoft/resources/css/app.css'), function () {
                            YZLoader.loadCss(YZLoader.$url('EMIP/resources/css/app.css'), function () {
                                Ext.Loader.loadScriptFile(YZLoader.$url('YZSoft/core/bpm-touch-all.js'), Ext.emptyFn, Ext.emptyFn, me, true);

                                application.pushPhase('initjs');

                                if (result.user.ScreenLock) {
                                    me.launchApp(result, function () {
                                        var pnl = Ext.create('YZSoft.personal.security.lock.Unlock', {
                                            fn: function () {
                                                me.launchApp(result);
                                            },
                                            relogin: function () {
                                                me.launchApp(result);
                                            }
                                        });

                                        pnl.on({
                                            single: true,
                                            show: function () {
                                                if (navigator.splashscreen) {
                                                    Ext.defer(function () {
                                                        navigator.splashscreen.hide();
                                                    }, 0);
                                                }
                                            }
                                        });

                                        Ext.mainWin.push(pnl);
                                    });
                                }
                                else {
                                    me.launchApp(result);
                                }
                            });
                        });
                    },
                    failure: function (action) {
                        me.login({
                            inited: function () {
                                me.destroyLoadingIndicator();
                            },
                            fn: function (result) {
                                me.launchApp(result);
                            }
                        });

                        if (action.result && action.result.prompt === true) {
                            Ext.Msg.show({
                                title: $rs.titleLoginFailed,
                                message: action.result.errorMessage,
                                hideOnMaskTap: true,
                                buttons: [{
                                    text: $rs.YesISee,
                                    flex: 1,
                                    cls: 'yz-button-flat yz-button-action-hot',
                                    itemId: 'ok'
                                }]
                            });
                        }
                    }
                });
            }
            else { //app登录界面
                me.login({
                    inited: function () {
                        me.destroyLoadingIndicator();
                    },
                    fn: function (result) {
                        me.launchApp(result);
                    }
                });
            }
        }
        else if (application.wechat) {
            var app = application.startApp;

            wx.error(function (res) {
                alert(res);
            });

            app.config = app.config || {};

            wx.config({
                beta: true,
                debug: false,
                appId: app.corpId,
                timestamp: app.timeStamp,
                nonceStr: app.nonceStr,
                signature: app.signature,
                jsApiList: app.jsApiList
            });

            Ext.Loader.setPath({
                YZSoft$Server: 'YZSoft$Server'
            });

            YZLoader.loadCss(YZLoader.$url('YZSoft/resources/css/app.css'), function () {
                YZLoader.loadCss(YZLoader.$url('EMIP/resources/css/app.css'), function () {
                    Ext.Loader.loadScriptFile(YZLoader.$url('YZSoft/core/bpm-touch-all.js'), Ext.emptyFn, Ext.emptyFn, me, true);

                    me.destroyLoadingIndicator();

                    me.wechatLogin({
                        fn: function (result) {
                            result.xclass = app.xclass;
                            result.config = app.config;
                            result.config.title = app.title;
                            me.launchApp(result);
                        },
                        failure: function (action) {
                            Ext.Msg.show({
                                title: $rs.titleLoginFailed,
                                message: action.result.errorMessage,
                                hideOnMaskTap: true,
                                buttons: [{
                                    text: $rs.YesISee,
                                    flex: 1,
                                    cls: 'yz-button-flat yz-button-action-hot',
                                    itemId: 'ok'
                                }]
                            });
                        }
                    });
                });
            });
        }
        else if (application.dingtalk) {
            var app = application.startApp;

            app.config = app.config || {};

            dd.config({
                agentId: app.agentId,
                corpId: app.corpId,
                timeStamp: app.timeStamp,
                nonceStr: app.nonceStr,
                signature: app.signature,
                jsApiList: app.jsApiList
            });

            Ext.Loader.setPath({
                YZSoft$Server: 'YZSoft$Server'
            });

            YZLoader.loadCss(YZLoader.$url('YZSoft/resources/css/app.css'), function () {
                YZLoader.loadCss(YZLoader.$url('EMIP/resources/css/app.css'), function () {
                    Ext.Loader.loadScriptFile(YZLoader.$url('YZSoft/core/bpm-touch-all.js'), Ext.emptyFn, Ext.emptyFn, me, true);

                    me.destroyLoadingIndicator();

                    me.dingtalkLogin({
                        fn: function (result) {

                            result.xclass = app.xclass;
                            result.config = app.config;
                            result.config.title = app.title;
                            me.launchApp(result);
                        },
                        failure: function (action) {
                            Ext.Msg.show({
                                title: $rs.titleLoginFailed,
                                message: action.result.errorMessage,
                                hideOnMaskTap: true,
                                buttons: [{
                                    text: $rs.YesISee,
                                    flex: 1,
                                    cls: 'yz-button-flat yz-button-action-hot',
                                    itemId: 'ok'
                                }]
                            });
                        }
                    });
                });
            });
        }
        else {
            Ext.Loader.setPath({
                YZSoft$Server: 'YZSoft$Server'
            });

            YZLoader.loadCss(YZLoader.$url('YZSoft/resources/css/app.css'), function () {
                YZLoader.loadCss(YZLoader.$url('EMIP/resources/css/app.css'), function () {
                    Ext.Loader.loadScriptFile(YZLoader.$url('YZSoft/core/bpm-touch-all.js'), Ext.emptyFn, Ext.emptyFn, me, true);

                    me.destroyLoadingIndicator();

                    switch (mode) {
                        case 'formpreview':   //移动表单设计预览
                            YZSoft.Globalization.JSLangInit.serverIndicated();

                            //创建表单
                            var formPanel = Ext.create('YZSoft.form.Simulate', {
                                processName: urlParams.processName,
                                version: urlParams.version,
                                uid: urlParams.uid
                            });

                            Ext.mainWin.push(formPanel);
                            break;
                        default:
                            if (application.debugAutoLogin) {  //调试模式自动登录
                                me.autoLogin({
                                    uid: '001',
                                    pwd: '',
                                    fn: function (result) {
                                        me.launchApp(result);
                                    },
                                    failure: function (action) {
                                        Ext.Msg.show({
                                            title: $rs.titleLoginFailed,
                                            message: action.result.errorMessage,
                                            hideOnMaskTap: true,
                                            buttons: [{
                                                text: $rs.YesISee,
                                                flex: 1,
                                                cls: 'yz-button-flat yz-button-action-hot',
                                                itemId: 'ok'
                                            }]
                                        });
                                    }
                                });
                            }
                            
                            else {   //正常网页登录
                                me.login({
                                    fn: function (result) {
                                        
                                        me.launchApp(result);
                                    }
                                });
                            }
                            break;
                    }
                });
            });
        }
    },

    destroyLoadingIndicator: function () {
        //        var el = Ext.fly('appLoadingIndicator');

        //        if (el)
        //            el.destroy();
    },

    login: function (args) {
        var me = this;

        if (args.inited)
            args.inited.call(args.scope);

        if (application.isApp) {
            me.showLoginPanel({
                selectServer: !application.specifiedServer,
                serverUrl: application.specifiedServer ? application.serverUrl : null,
                loginRequestConfig: args.loginRequestConfig,
                fn: function (result, url) {
                    url += '/';

                    if (result.LocalLibrary !== true) {
                        Ext.Loader.setPath({
                            YZSoft: url + 'YZSoft'
                        });
                    }

                    YZLoader.loadCss(YZLoader.$url('YZSoft/resources/css/app.css'), function () {
                        YZLoader.loadCss(YZLoader.$url('EMIP/resources/css/app.css'), function () {
                            Ext.Loader.loadScriptFile(YZLoader.$url('YZSoft/core/bpm-touch-all.js'), Ext.emptyFn, Ext.emptyFn, me, true);

                            Ext.Viewport.unmask();

                            if (args.fn)
                                args.fn.call(args.scope, result);
                        });
                    });
                }
            });
        }
        else {
            me.showLoginPanel({
                selectServer: false,
                loginRequestConfig: args.loginRequestConfig,
                fn: function (result, url) {
                    Ext.Viewport.unmask();

                    if (args.fn)
                        args.fn.call(args.scope, result);
                }
            });
        }
    },

    showLoginPanel: function (args) {
        var me = this,
            pnl;

        //为子类中的requires异步加载
        Ext.Loader.require('YZSoft$Boot.login.Panel', function () {
            pnl = Ext.create('YZSoft$Boot.login.Panel', {
                loginRequestConfig: args.loginRequestConfig,
                selectServer: args.selectServer,
                serverUrl: args.serverUrl,
                fn: function (result, url) {
                    Ext.apply(Ext.Loader, {
                        JSCache: result.JSCache,
                        JSVersion: result.JSVersion
                    });

                    if (args.fn)
                        args.fn.call(args.scope, result, url);
                }
            });

            Ext.mainWin.push(pnl);
        });
    },

    wechatLogin: function (args) {
        //        wx.ready(function () {
        //        });
        wx.hideMenuItems({
            menuList: ['refresh'] // 要隐藏的菜单项，所有menu项见附录3
        });
        YZLoader.Ajax.request({
            method: 'POST',
            url: YZLoader.$url('YZSoft.Services.REST.Mobile/core/Auth.ashx'),
            params: {
                Method: 'WeChatLogin',
                lang: YZLoader.Globalization.getLang()
            },
            success: function (action) {
                var result = action.result;

                Ext.apply(Ext.Loader, {
                    JSCache: result.JSCache,
                    JSVersion: result.JSVersion
                });

                if (args.fn)
                    args.fn.call(args.scope, result);
            },
            failure: function (action) {
                if (args.failure)
                    args.failure.call(args.scope, action);
            }
        });
    },

    dingtalkLogin: function (args) {
        dd.error(function (error) {
            alert('dd error: ' + JSON.stringify(error));
        });
        dd.ready(function () {
            dd.runtime.permission.requestAuthCode({
                corpId: application.startApp.corpId,
                onSuccess: function (result) {

                    YZLoader.Ajax.request({
                        method: 'POST',
                        url: YZLoader.$url('YZSoft.Services.REST.Mobile/core/Auth.ashx'),
                        params: {
                            Method: 'DingTalkLogin',
                            corpId: application.startApp.corpId,
                            appSecret: application.startApp.secret,
                            code: result.code,
                            lang: YZLoader.Globalization.getLang()
                        },
                        success: function (action) {
                            var result = action.result;

                            Ext.apply(Ext.Loader, {
                                JSCache: result.JSCache,
                                JSVersion: result.JSVersion
                            });

                            if (args.fn)
                                args.fn.call(args.scope, result);
                        },
                        failure: function (action) {
                            if (args.failure)
                                args.failure.call(args.scope, action);
                        }
                    });
                },
                onFail: function (err) {
                    alert(err.errorMessage);
                }
            });
        });
    },

    autoLogin: function (args) {
        Ext.Loader.syncRequire('YZSoft$Boot.src.Device');

        YZLoader.Ajax.request({
            url: YZLoader.$url('YZSoft.Services.REST.Mobile/core/Auth.ashx'),
            params: {
                method: 'GetPublicKey'
            },
            success: function (action) {
                var keyInfo = action.result,
                    encrypt = new JSEncrypt();

                encrypt.setPublicKey(keyInfo.publicKey);
                YZLoader.Ajax.request({
                    method: 'POST',
                    url: YZLoader.$url('YZSoft.Services.REST.Mobile/core/Auth.ashx'),
                    params: {
                        Method: 'Login',
                        uid: encrypt.encrypt(args.uid),
                        pwd: encrypt.encrypt(args.pwd),
                        lang: YZLoader.Globalization.getLang(),
                        isapp: application.isApp,
                        cordova: YZSoft$Boot.src.Device.cordova,
                        name: YZSoft$Boot.src.Device.name,
                        model: YZSoft$Boot.src.Device.model,
                        platform: YZSoft$Boot.src.Device.platform,
                        uuid: YZSoft$Boot.src.Device.uuid,
                        version: YZSoft$Boot.src.Device.version,
                        manufacturer: YZSoft$Boot.src.Device.manufacturer,
                        isVirtual: YZSoft$Boot.src.Device.isVirtual,
                        serial: YZSoft$Boot.src.Device.serial,
                        validationPanelShow: false,
                        keystore: keyInfo.keystore
                    },
                    success: function (action) {
                        var result = action.result;

                        Ext.apply(Ext.Loader, {
                            JSCache: result.JSCache,
                            JSVersion: result.JSVersion
                        });

                        if (args.fn)
                            args.fn.call(args.scope, result);
                    },
                    failure: function (action) {
                        if (args.failure)
                            args.failure.call(args.scope, action);
                    }
                });
            },
            failure: function (action) {
                if (args.failure)
                    args.failure.call(args.scope, action);
            }
        });
    },

    launchApp: function (result, fn, scope) {
        var me = this;

        application.pushPhase('benginLaunchApp');

        RS.clearErrors();
        YZSoft.Globalization.JSLangInit.serverIndicated();

        me.clearCatch();

        YZSoft.LoginUser = result.user;
        YZSoft.serverSetting = result;
        if (!YZSoft.LoginUser)
            return;

        if (fn) {
            fn.call(scope, result);
        }
        else {
            if ((result.ver || 1) < 2) {
                application.pushPhase('initPush');

                Ext.Loader.require('YZSoft.src.ux.Push', function () {
                    YZSoft.src.ux.Push.init({
                        fn: function () {
                            application.pushPhase('createMainWin');
                            me.createMainWin(result);
                        }
                    });
                });
            }
            else {
                application.pushPhase('createMainWin');
                me.createMainWin(result);
            }
        }
    },

    createMainWin: function (result) {

        //采购申请
        //        YZSoft.home = Ext.create('YZSoft.form.Post', {
        //            title: '采购申请',
        //            processName: '采购申请'
        //        });

        //采购申请第三方表单
        //YZSoft.home = Ext.create('YZSoft.form.Post', {
        //    title: '采购申请',
        //    processName: '采购008',
        //    prompt: true
        //});

        //审批1
        //YZSoft.home = Ext.create('YZSoft.form.Process', {
        //    pid: 639511,
        //    title: '测试'
        //});

        //读
        //YZSoft.home = Ext.create('YZSoft.form.Read', {
        //    tid: 281940,
        //    title: '采购申请'
        //});


        //YZSoft.home = Ext.create('YZSoft.post.Panel', {
        //});

        //开窗查询
        //YZSoft.home = Ext.create('YZSoft.src.panel.DataBrowser', {
        //    title: '开窗查询',
        //    datasource: {
        //        datasource: '',
        //        //filter: {
        //        //    Vendor: {
        //        //        op: '>',
        //        //        value: 1
        //        //    }
        //        //},
        //        orderBy: null,
        //        tableName: 'iDemoProduct',
        //    },
        //    displayColumns: [{
        //        columnName: 'ProdCode',
        //        displayName: '产品代码'
        //    }, {
        //        columnName: 'Vendor'
        //    }, {
        //        columnName: 'Name'
        //    }, {
        //        columnName: 'Price'
        //    }, {
        //            columnName: 'UpdateDate'
        //    }],
        //    singleSelection: true
        //});

        //YZSoft.home = Ext.create('YZSoft.src.panel.databrowser.SearchPanel', {
        //    params: [{
        //        "name": "String",
        //        "displayName": "String",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Date",
        //        "displayName": "Date",
        //        "dataType": {
        //            "name": "DateTime",
        //            "fullName": "System.DateTime"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "String2",
        //        "displayName": "String2",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Number",
        //        "displayName": "Number",
        //        "dataType": {
        //            "name": "Decimal",
        //            "fullName": "System.Decimal"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Boolean",
        //        "displayName": "Boolean",
        //        "dataType": {
        //            "name": "Boolean",
        //            "fullName": "System.Boolean"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "String",
        //        "displayName": "String",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Date",
        //        "displayName": "Date",
        //        "dataType": {
        //            "name": "DateTime",
        //            "fullName": "System.DateTime"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "String2",
        //        "displayName": "String2",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Number",
        //        "displayName": "Number",
        //        "dataType": {
        //            "name": "Decimal",
        //            "fullName": "System.Decimal"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Boolean",
        //        "displayName": "Boolean",
        //        "dataType": {
        //            "name": "Boolean",
        //            "fullName": "System.Boolean"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "String",
        //        "displayName": "String",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Date",
        //        "displayName": "Date",
        //        "dataType": {
        //            "name": "DateTime",
        //            "fullName": "System.DateTime"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "String2",
        //        "displayName": "String2",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Number",
        //        "displayName": "Number",
        //        "dataType": {
        //            "name": "Decimal",
        //            "fullName": "System.Decimal"
        //        },
        //        "supportOp": true
        //    }, {
        //        "name": "Boolean",
        //        "displayName": "Boolean",
        //        "dataType": {
        //            "name": "Boolean",
        //            "fullName": "System.Boolean"
        //        },
        //        "supportOp": true
        //    }]
        //});


        //YZSoft.home = Ext.create('YZSoft.src.panel.databrowser.RecordDetail', {
        //    displayColumns: [{
        //        "columnName": "ProdCode",
        //        "displayName": "产品代码",
        //        "dataType": {
        //            "name": "String",
        //            "fullName": "System.String"
        //        },
        //        "width": null
        //    }, {
        //    "columnName": "Boolean",
        //    "displayName": "Boolean",
        //    "dataType": {
        //        "name": "Boolean",
        //        "fullName": "System.Boolean"
        //    },
        //    "width": null
        //    }, {
        //        "columnName": "UpdateDate",
        //        "displayName": "UpdateDate",
        //        "dataType": {
        //            "name": "DateTime",
        //            "fullName": "System.DateTime"
        //        },
        //        "width": null
        //    }, { "columnName": "Vendor", "dataType": { "name": "String", "fullName": "System.String" }, "width": null }, { "columnName": "Name", "dataType": { "name": "String", "fullName": "System.String" }, "width": null }, { "columnName": "Price", "dataType": { "name": "Decimal", "fullName": "System.Decimal" }, "width": null }],
        //    record: {
        //        data: {
        //            "ProdCode": "001",
        //            "TypeCode": null,
        //            "Vendor": null,
        //            "Name": "HTYC90\u578b\u6f5c\u6c34\u63a8\u8fdb\u5668HTYC90\u578b\u6f5c\u6c34\u63a8\u8fdb\u5668HTYC90\u578b\u6f5c\u6c34\u63a8\u8fdb\u5668HTYC90\u578b\u6f5c\u6c34\u63a8\u8fdb\u5668",
        //            "Price": 0,
        //            "Unit": null,
        //            "UpdateDate": "2019-10-11 03:52:00",
        //            "Boolean":null,
        //            "id": "ext-record - 1"
        //        }
        //    },
        //    singleSelection: true
        //});

        //YZSoft.home = Ext.create('YZSoft.src.panel.SelOU', {
        //});

        //请假申请
        //        YZSoft.home = Ext.create('YZSoft.form.Post', {
        //            title: '请假申请',
        //            processName: '$请假'
        //        });

        //报销
        //        YZSoft.home = Ext.create('YZSoft.form.Post', {
        //            form: {
        //                xclass: 'YZSoft.request.forms.Expense'
        //            },
        //            title: '报销',
        //            processName: '$报销'
        //        });

        //联动
        //        YZSoft.home = Ext.create('YZSoft.form.Post', {
        //            title: RS.$('All_Apps_FieldsDemo_Title'),
        //            processName: '$移动表单控件',
        //            form: {
        //                xclass: 'YZSoft.demo.HideShow'
        //            }
        //        });

        //发起
        //        YZSoft.home = Ext.create('YZSoft.request.MainPanel', {
        //            title:'发起申请'
        //        });

        //        YZSoft.home = Ext.create('YZSoft.form.SubmitSheet', {
        //            inviteIndicate: true,
        //            consign: true,
        //            declares: [{
        //                "TargetStepName": "经理审批",
        //                "MultiRecipient": true,
        //                "RoutingType": "None",
        //                "JumpIfNoParticipants": false
        //            }]
        //        });

        //账号安全
        //        YZSoft.home = Ext.create('YZSoft.personal.security.MainPanel', {
        //            title:'账号与安全'
        //        });

        //账号保护
        //        YZSoft.home = Ext.create('YZSoft.personal.security.protect.MainPanel', {
        //            title:'账号保护'
        //        });

        //账号保护
        //        YZSoft.home = Ext.create('YZSoft.personal.security.bind.PhoneNumber', {
        //            title:'绑定手机号'
        //        });

        //更换手机号
        //        YZSoft.home = Ext.create('YZSoft.personal.security.bind.ChangeWelcome', {
        //            title:'更换手机号'
        //        });

        //修改密码
        //        YZSoft.home = Ext.create('YZSoft.personal.security.password.Change', {
        //            title:'修改密码'
        //        });

        //软键盘
        //        YZSoft.home = Ext.create('YZSoft.src.panel.SoftKeyboardTel', {
        //        });

        //设置安全锁密码
        //        YZSoft.home = Ext.create('YZSoft.personal.security.lock.LockMainPanel', {
        //            title:'安全密码锁定'
        //        });

        //验证解锁码
        //        YZSoft.home = Ext.create('YZSoft.personal.security.lock.ValidatePassword', {
        //            title: '输入密码'
        //        });

        //验证解锁码
        //                YZSoft.home = Ext.create('YZSoft.personal.security.lock.ChangePassword', {
        //                    title: '输入密码'
        //                });

        //解锁
        //        YZSoft.home = Ext.create('YZSoft.personal.security.lock.Unlock', {
        //            fn: function () {
        //                alert('aaa');
        //            }
        //        });

        //多语言
        //        YZSoft.home = Ext.create('YZSoft.personal.setting.Lang', {
        //            title:'多语言'
        //        });

        //外出设置
        //        YZSoft.home = Ext.create('YZSoft.personal.setting.OutOfOffice', {
        //            title:'外出设置'
        //        });


        //新消息通知
        //        YZSoft.home = Ext.create('YZSoft.personal.setting.Message', {
        //            title: '新消息通知'
        //        });

        //关于企信通
        //                YZSoft.home = Ext.create('YZSoft.personal.about.About',{
        //                    title:'关于企信通'
        //                });


        //任务交流
        //        YZSoft.home = Ext.create('YZSoft.social.chat.TaskChatPanel', {
        //            title: '流程交流',
        //            tid: 85 //85
        //        });

        //任务交流
        //        YZSoft.home = Ext.create('YZSoft.tools.test', {
        //        });

        //图片预览
        //        YZSoft.home = Ext.create('YZSoft.src.panel.ImageViewer', {
        //            imageSrc: Ext.String.urlAppend(YZSoft.$url('YZSoft.Services.REST/Attachment/Download.ashx'), Ext.Object.toQueryString({
        //                Method: 'ImageStreamFromFileID',
        //                fileid: '201703090001',
        //                dc: +new Date()
        //            }))
        //        });

        //视频播放
        //        YZSoft.home = Ext.create('YZSoft.src.panel.VideoPlayer', {
        //            url: Ext.String.urlAppend(YZSoft.$url('YZSoft.Services.REST/Attachment/Download.ashx'), Ext.Object.toQueryString({
        //                Method: 'VideoStreamFromFileID',
        //                fileid: '201703150002',
        //                fileid: '201703160001',
        //                dc: +new Date()
        //            })),
        //            posterUrl:Ext.String.urlAppend(YZSoft.$url('YZSoft.Services.REST/Attachment/Download.ashx'), Ext.Object.toQueryString({
        //                Method: 'ImageStreamFromFileID',
        //                fileid: '201703150002',
        //                fileid: '201703160001',
        //                dc: +new Date()
        //            }))
        //        });

        //表情输入
        //        YZSoft.home = Ext.create('YZSoft.src.panel.social.Face', {
        //        });

        //录音
        //        YZSoft.home = Ext.create('YZSoft.src.panel.MiniAudioCapture', {
        //        });

        //拒绝通知
        //        YZSoft.home = Ext.create('YZSoft.social.notify.NotifyPanel', {
        //            title: '拒绝通知',
        //            resType: 'TaskRejected',
        //            resId: '99199',
        //            back: function () {
        //                Ext.mainWin.pop();
        //            }
        //        });

        //核准通知
        //        YZSoft.home = Ext.create('YZSoft.social.notify.NotifyPanel', {
        //            title: '核准通知',
        //            resType: 'TaskApproved',
        //            resId: '99199'
        //        });

        //发起聊天
        //        YZSoft.home = Ext.create('YZSoft.social.chat.StartChat', {
        //            title: '选择联系人'
        //        });

        //选择群
        //        YZSoft.home = Ext.create('YZSoft.src.panel.SelGroup', {
        //            title: '选择一个群'
        //        });

        //群设置
        //                YZSoft.home = Ext.create('YZSoft.social.group.Setting', {
        //                    title: '群聊',
        //                    groupid: 70
        //                });

        //删除群成员
        //        YZSoft.home = Ext.create('YZSoft.social.group.DeleteGroupMember', {
        //            title: '删除成员',
        //            groupid: 70
        //        });

        //聊天搜索
        //        YZSoft.home = Ext.create('YZSoft.social.SearchPanel', {
        //        });

        //待办搜索
        //        YZSoft.home = Ext.create('YZSoft.task.filter.WorkList', {
        //        });

        //历史任务搜索
        //        YZSoft.home = Ext.create('YZSoft.task.filter.HistoryTask', {
        //        });

        //日报
        //        YZSoft.home = Ext.create('YZSoft.apps.dailyreport.Main', {
        //        });

        //写日报
        //        YZSoft.home = Ext.create('YZSoft.form.Post', {
        //            form: {
        //                xclass: 'YZSoft.apps.dailyreport.form.DailyReport'
        //            },
        //            title: '写日报',
        //            processName: '$日报',
        //            prompt:true
        //            //restartTaskID:307
        //        });

        //日报
        //        YZSoft.home = Ext.create('YZSoft.apps.dailyreport.panel.DailyReport', {
        //            title: '日报',
        //            account: '99199',
        //            date: new Date(2017,5,10)
        //                });

        //团队日报
        //        YZSoft.home = Ext.create('YZSoft.apps.dailyreport.team.Main', {
        //            account:'99199'
        //        });

        //周报
        //        YZSoft.home = Ext.create('YZSoft.apps.weeklyreport.Main', {
        //        });

        //月报
        //        YZSoft.home = Ext.create('YZSoft.apps.monthlyreport.Main', {
        //        });


        //团队周报
        //        YZSoft.home = Ext.create('YZSoft.apps.weeklyreport.team.Main', {
        //            title: '团队周报',
        //            iconCls: ['yz-glyph', 'yz-glyph-tab-dailyreport-team'],
        //            account: '99199'
        //        });

        //公司通讯录
        //        YZSoft.home = Ext.create('YZSoft.apps.addressbook.MainPanel', {
        //            title: '通讯录'
        //        });

        //个人信息
        //        YZSoft.home = Ext.create('YZSoft.src.panel.CompanyContactPanel', {
        //            uid: '99199'
        //        });

        //控件汇总
        //YZSoft.home = Ext.create('YZSoft.form.Post', {
        //    form: {
        //        xclass: 'YZSoft.demo.FormFields'
        //    },
        //    processName: '$移动表单控件'
        //    //restartTaskID:307
        //});

        //控件
        //YZSoft.home = Ext.create('YZSoft.form.Post', {
        //    form: {
        //        xclass: 'YZSoft.demo.field.Checkbox'
        //    },
        //    processName: '$移动表单控件'
        //});

        //文件打开
        //        YZSoft.home = Ext.create('YZSoft.src.panel.FileViewer', {
        //            url: 'http://192.169.1.100/emip/YZSoft.Services.REST/Attachment/Download.ashx?method=Download&fileid=201507210118',
        //            fileName: 'table_export.xls',
        //            ext:'.xls',
        //            size:2048
        //        });


        //个人BPM报表
        //        YZSoft.home = Ext.create('YZSoft.apps.bpmreport.personal.Main', {
        //            uid: YZSoft.LoginUser.Account
        //        });

        //服务中心
        //        YZSoft.home = Ext.create('YZSoft.personal.service.ContactsPanel', {
        //        });

        //        YZSoft.home = Ext.create('YZSoft.src.panel.fileviewer.Download', {
        //        });

        //微信待办
        //YZSoft.home = Ext.create('YZSoft.task.MainPanel', {
        //});

        //选择控件
        //YZSoft.home = Ext.create('YZSoft.demo.field.Select', {
        //});

        //调试发起
        //YZSoft.home = Ext.create('YZSoft.request.MainPanel', {
        //    title:'发起申请'
        //});

        //YZSoft.home = Ext.create('YZSoft.form.Post', {
        //    form: {
        //        xclass: 'YZSoft.request.forms.BusinessTrip1'
        //    },
        //    title: '出差',
        //    processName: '出差1'
        //});

        //YZSoft.home = Ext.create('YZSoft.apps.footmark.form.Submit', { title: '签到' });
        //YZSoft.home = Ext.create('YZSoft.apps.footmark.team.Main');
        //YZSoft.home = Ext.create('YZSoft.apps.footmark.Main');
        //YZSoft.home = Ext.create('YZSoft.apps.footmark.personal.List', {title:'全茂林',account:'99199'});
        //YZSoft.home = Ext.create('YZSoft.apps.footmark.form.Sign', { title: '签到' });
        //YZSoft.home = Ext.create('YZSoft.apps.speak.ListPanel');
        //YZSoft.home = Ext.create('YZSoft.apps.cash.Form');
        //YZSoft.home = Ext.create('YZSoft.apps.cash.ListPanel');
        //YZSoft.home = Ext.create('YZSoft.apps.barcode.Scan');
        //YZSoft.home = Ext.create('YZSoft.apps.barcode.ListPanel');
        //YZSoft.home = Ext.create('YZSoft.src.panel.SelUser');

        //result.xclass = 'YZSoft.task.MainPanel'; //钉钉微信测试 - 流程审批
        //result.xclass = 'YZSoft.request.MainPanel'; //钉钉微信测试 - 流程发起
        //result.xclass = 'EMIP.view.Main'; //钉钉微信测试 - 企信通
        //result.xclass = 'YZSoft.form.MessageCardOpenTask'; //钉钉微信测试 - 打开表单查看
        //result.xclass = 'YZSoft.form.MessageCardProcess'; //钉钉微信测试 - 打开表单处理
        //result.config = {
        //    tid: 281628,
        //    pid: 636423
        //};

        //可使xclass类中的require对象并行加载，否则串行加载
        Ext.Loader.require(result.xclass, function () {
            YZSoft.home = YZSoft.home || Ext.create(result.xclass, result.config);
            Ext.mainWin.push(YZSoft.home);

            if (window.StatusBar)
                StatusBar.styleDefault();
        });

        //锁屏幕保护
        //        var screenlock = Ext.create('YZSoft.personal.security.lock.Unlock', {
        //            fn: function () {
        //                Ext.mainWin.pop();
        //            },
        //            relogin: function () {
        //                Ext.mainWin.pop(2);
        //            }
        //        });

        //        Ext.mainWin.getLayout().getAnimation().disable();
        //        Ext.mainWin.push(screenlock);
        //        Ext.mainWin.getLayout().getAnimation().enable();

        //Ext.Viewport.add(screenlock);
        //screenlock.show();

        //密码验证
        //        var dlg = Ext.create('YZSoft.src.panel.PasswordValidate', {
        //            title: '修改登录密码',
        //            message: '请输入当前的登录密码'
        //        });

        //        Ext.Viewport.add(dlg);
        //        dlg.show();
    },

    clearCatch: function () {
        //        if (!application.isApp || !window.requestFileSystem)
        //            return;

        //        window.requestFileSystem(LocalFileSystem.TEMPORARY, 0,
        //            function (fileSystem) {
        //                fileSystem.root.getDirectory("download", { create: false, exclusive: false },
        //                    function (entry) {
        //                        entry.removeRecursively();
        //                    }
        //                );
        //                fileSystem.root.getDirectory("FlowPortal", { create: false, exclusive: false },
        //                    function (entry) {
        //                        entry.removeRecursively();
        //                    }
        //                );
        //            }
        //        );
    },

    onUpdated: function () {
        Ext.Msg.confirm(
            "Application Update",
            "This application has just successfully been updated to the latest version. Reload now?",
            function (buttonId) {
                if (buttonId === 'yes') {
                    window.location.reload();
                }
            }
        );
    },

    backup: function () {
        var me = this,
            backup = application.backup = {};

        Ext.Object.each(me.backupItems, function (objectName, propNames) {
            var srcObject = eval(objectName),
                tagObject = backup[objectName] = {};

            Ext.each(propNames, function (propName) {
                tagObject[propName] = Ext.clone(srcObject[propName]);
            });
        });
    },

    restore: function () {
        var me = this,
            backup = application.backup,
            classes = backup['Ext.ClassManager'].classes,
            i;

        Ext.Object.each(Ext.ClassManager.classes, function (className) {
            if (!classes.hasOwnProperty(className)) {
                var root = Ext.global,
                parts = Ext.ClassManager.parseNamespace(className),
                part, i, ln;

                for (i = 0, ln = parts.length; i < ln; i++) {
                    part = parts[i];

                    if (typeof part != 'string') {
                        root = part;
                    } else {
                        if (!root || !root[part]) {
                            return null;
                        }

                        if (i == ln - 1)
                            delete root[part];
                        else
                            root = root[part];
                    }
                }
            }
        });

        Ext.Object.each(me.backupItems, function (objectName, propNames) {
            var srcObject = backup[objectName],
                tagObject = eval(objectName);

            Ext.each(propNames, function (propName) {
                tagObject[propName] = Ext.clone(srcObject[propName]);
            });
        });
    },

    removeAllWins: function () {
        Ext.Viewport.removeAll(true);
        Ext.mainWin = Ext.create('Ext.navigation.View', {
            navigationBar: false
        });
        Ext.Viewport.add(Ext.mainWin);
    }
});
